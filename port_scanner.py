#!/usr/bin/env python3
import sys
import socket


ip = input("\n[*] Please enter IP: ")
ports = range(1, 65535)
open_ports = []


# Create scan port function with default return code of 1.
def scan_port(ip, port, result = 1):
    try:
        # Setting scan for IPv4 and TCP.
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(0.5)
        # Uses connect_ex to connect and return an exit code/return value.
        return_code = sock.connect_ex((ip, port))
        if return_code == 0:
            result = return_code
            sock.close()
    except Exception as e:
        pass
    return result


# Scanning each port.
for port in ports:
    # Flushes the buffer after each iteration.
    sys.stdout.flush()
    response = scan_port(ip, port)
    if response == 0:
        open_ports.append(port)


# Print results.
if open_ports:
    print("[+] Open Ports:", sorted(open_ports))
else:
    print("[-] No ports open.")
