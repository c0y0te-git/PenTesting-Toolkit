#!/usr/bin/env python3
from scapy.all import *
''' A network ARP scanner, which uses the Scapy module to ARP ping an entire network.
- c0y0te 9/28/2021 '''

# Getting interface and IP range to scan.
interface = input("[*] Please enter network interface (ex. eth0): ")
ip_range = input("[*] Please enter IP range (ex. 192.168.X.X/24): ")
broadcast_mac = "ff:ff:ff:ff:ff:ff"

# Constructing packet.
packet = Ether(dst=broadcast_mac)/ARP(pdst = ip_range)

# Sending and receiving packet to Layer 2. 
ans, uans = srp(packet, timeout = 2, iface = interface)

# Print the received ARP IP and MAC addresses.
for send, receive in ans:
    print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))

